{% extends 'rdv_app/base.html' %}

{% block title %}Gérer les ateliers{% endblock %}

{% block content %}
<div class="container" style="max-width:900px;">
  <h2 class="mb-4 text-center">Gestion des ateliers</h2>
  <div class="row">
    <div class="col-md-5">
      <h5>{% if edit_id %}Modifier l'atelier{% else %}Ajouter un atelier{% endif %}</h5>
      <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary w-100 mt-2">{% if edit_id %}Enregistrer{% else %}Ajouter{% endif %}</button>
        {% if edit_id %}
          <a href="{% url 'ateliers_admin' %}" class="btn btn-link w-100 mt-2">Annuler</a>
        {% endif %}
      </form>
    </div>
    <div class="col-md-7">
      <h5>Liste des ateliers</h5>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Titre</th><th>Date</th><th>Tarif</th><th>Inscrits</th><th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for atelier in ateliers %}
          <tr>
            <td>{{ atelier.titre }}</td>
            <td>{{ atelier.date|date:"d/m/Y" }}</td>
            <td>{{ atelier.tarif }} €</td>
            <td>
              {% for user in atelier.participants.all %}
                <span class="badge bg-info text-dark">{{ user.get_full_name|default:user.username }}</span>
              {% empty %}
                <span class="text-muted">Aucun</span>
              {% endfor %}
            </td>
            <td>
              <a href="{% url 'ateliers_admin' %}?edit={{ atelier.id }}" class="btn btn-sm btn-warning">Modifier</a>
              <form method="post" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="delete_id" value="{{ atelier.id }}">
                <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Supprimer cet atelier ?');">Supprimer</button>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="5" class="text-center text-muted">Aucun atelier</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %} 